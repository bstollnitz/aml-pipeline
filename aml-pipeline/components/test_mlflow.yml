$schema: https://azuremlschemas.azureedge.net/latest/commandComponent.schema.json
name: component_test
version: 1
type: command

inputs:
  model_dir:
    type: mlflow_model
  test_data:
    type: uri_file

environment:
  image: mcr.microsoft.com/azureml/openmpi3.1.2-cuda10.2-cudnn8-ubuntu18.04:latest
  conda_file: ../cloud/conda.yml

code: .
command: >-
  echo Testing MLflow model && 
  mlflow models predict -m ${{inputs.model_dir}} -i ${{inputs.test_data}} -t json &&
  echo

